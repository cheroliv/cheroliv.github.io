<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Cheroliv - Développeur Formateur | Ingénierie Pédagogique</title>

    <script>
        // IIFE to avoid polluting global scope
        (function() {
          try {
            const theme = localStorage.getItem('preferred-theme');
            if (theme) {
              document.documentElement.setAttribute('data-bs-theme', theme);
            }
          } catch (e) {
            // Reading from localStorage can fail in private browsing mode on some browsers
            console.warn('Could not set theme from localStorage', e);
          }
        })();
    </script>

    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.css" rel="stylesheet" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- intl-tel-input CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/intl-tel-input@25.10.1/build/css/intlTelInput.css">

    <!-- Custom CSS -->
    <link href="../../css/styles.css" rel="stylesheet" />

    <!-- highlight.js: theme will be managed dynamically by script.js -->
    <link id="highlight-js-theme" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/default.min.css">

    <link href="../../css/asciidoctor.css" rel="stylesheet"/>



    <!-- Favicon -->
    <link rel="shortcut icon"
          href="../..//img/cheroliv_logo_icon.png"/>



    <!-- Meta tags pour SEO -->
    <meta name="description" content="Développeur formateur spécialisé en ingénierie pédagogique. Conception et développement de solutions e-learning innovantes."/>
    <meta name="keywords" content="développement, formation, e-learning, ingénierie pédagogique, JavaScript, Bootstrap"/>
    <meta name="author" content="Cheroliv"/>
</head>
<body>
<div class="main-content-wrapper">
    <div>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="../../index.html#home">
                <i class="bi bi-code-slash me-2"></i>
                Cheroliv
            </a>

            <button class="navbar-toggler"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#navbarNav"
                    aria-controls="navbarNav"
                    aria-expanded="false"
                    aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-start">
                    <li class="nav-item">
                        <a class="nav-link" href="../../index.html#home">Accueil</a>
                    </li>
<!--                    <li class="nav-item">-->
<!--                        <a class="nav-link" th:href="${isIndexPage ? '#about' : content.rootpath + 'index.html#about'}">À propos</a>-->
<!--                    </li>-->
                    <li class="nav-item">
                        <a class="nav-link" href="../../index.html#services">Services</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../../index.html#expertise">Expertise</a>
                    </li>
<!--                    <li class="nav-item"> -->
<!--                        <a class="nav-link" th:href="${isIndexPage ? '#formations' : content.rootpath + 'index.html#formations'}">Formations</a>-->
<!--                    </li>-->
<!--                    <li class="nav-item">-->
<!--                        <a class="nav-link" th:href="${isIndexPage ? '#portfolio' : content.rootpath + 'index.html#portfolio'}">Portfolio</a>-->
<!--                    </li>-->
                    <li class="nav-item">
                        <a class="nav-link" href="../../blog.html">Blog</a>
                    </li>
<!--                    <li class="nav-item dropdown">-->
<!--                        <a class="nav-link dropdown-toggle"-->
<!--                           href="#"-->
<!--                           id="memosDropdown"-->
<!--                           role="button"-->
<!--                           data-bs-toggle="dropdown"-->
<!--                           aria-expanded="false">-->
<!--                            <i class="fa-duotone fa-memo"></i> Memos-->
<!--                        </a>-->
<!--                        <ul class="dropdown-menu" aria-labelledby="memosDropdown">-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2022/0052_memo_jvm_post.html'}"><i class="fa-brands fa-java"></i> jvm</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2022/0053_memo_kotlin_post.html'}"><i class="fa-brands fa-korvue"></i> kotlin</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2022/0047_memo_gradle_post.html'}"><i class="fa-solid fa-industry"></i> gradle</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2023/0060_memo_js_post.html'}"><i class="fa-brands fa-square-js"></i> javascript</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2023/0063_memo_ts_post.html'}"><i class="fa-brands fa-square-js"></i> typescript</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2023/0062_memo_css_post.html'}"><i class="fa-brands fa-css3-alt"></i> css</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2023/0061_memo_html_post.html'}"><i class="fa-brands fa-html5"></i> html</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2023/0066_memo_python_post.html'}"><i class="fa-brands fa-python"></i> python</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2020/0021_memo_git_post.html'}"><i class="fa-brands fa-git-alt"></i> git</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2021/0030_memo_linux_post.html'}"><i class="fa-brands fa-linux"></i> linux</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2022/0054_memo_cadrage_post.html'}"><i class="fa-solid fa-arrows-split-up-and-left"></i> cadrage</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2022/0031_memo_design_system_post.html'}"><i class="fa-solid fa-pencil"></i> design system</a></li>-->
<!--                            <li><a class="dropdown-item" th:href="@{${content.rootpath} + 'blog/2020/0016_asciidoc_markdown_memo_post.html'}"><i class="fa-brands fa-markdown"></i> asciidoc/markdown</a></li>-->
<!--                        </ul>-->
<!--                    </li>-->
<!--                    <li class="nav-item">-->
<!--                        <a class="nav-link" th:href="${isIndexPage ? '#contact' : content.rootpath + 'index.html#contact'}">Contact</a>-->
<!--                    </li>-->

                    <li class="nav-item">
                        <a class="nav-link" href="mailto:cheroliv.developer@gmail.com">Contact</a>
                    </li>
                </ul>
                <!-- Theme Switcher moved outside the ul for simpler flexbox calculation -->
                <div class="nav-item dropdown theme-switcher-container ms-lg-3">
                    <button class="btn btn-outline-secondary dropdown-toggle theme-dropdown-btn"
                            type="button"
                            id="themeDropdown"
                            data-bs-toggle="dropdown"
                            aria-expanded="false"
                            aria-label="Sélectionner le thème de l'interface">
                        <i class="bi bi-sun"></i>
                        <span id="current-theme" class="visually-hidden">Light</span>
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="themeDropdown">
                        <li><button class="dropdown-item theme-option"
                                    type="button"
                                    data-theme="light">
                            <i class="bi bi-sun me-2"></i>Light
                        </button></li>
                        <li><button class="dropdown-item theme-option" type="button" data-theme="dark">
                            <i class="bi bi-moon me-2"></i>Dark
                        </button></li>
                        <li><button class="dropdown-item theme-option" type="button" data-theme="high-contrast">
                            <i class="bi bi-circle-half me-2"></i>High Contrast
                        </button></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
</div>
    <main class="container main-content-padding" id="main-content">
        <article>
            <header class="page-header mb-4">
                <h1 class="h2">L Art du Pré-chargement : Éliminer le &quot;Flash&quot; de Thème avec JavaScript et CSS</h1>
                <p class="lead">
                    <em>Publié le 15 November 2025</em>
                </p>
            </header>

            <div class="content"><div id="toc" class="toc">
<div id="toctitle">Table des matières</div>
<ul class="sectlevel1">
<li><a href="#résumé">Résumé</a></li>
<li><a href="#le_problème_ce_maudit_clignotement_de_thème">1. Le Problème : Ce Maudit Clignotement de Thème</a>
<ul class="sectlevel2">
<li><a href="#un_cauchemar_pour_lexpérience_utilisateur">1.1. Un Cauchemar pour l&#8217;Expérience Utilisateur</a></li>
<li><a href="#le_fouc_un_vieux_problème_web">1.2. Le FOUC : Un Vieux Problème Web</a></li>
<li><a href="#impact_sur_la_perception_de_qualité">1.3. Impact sur la Perception de Qualité</a></li>
<li><a href="#analyse_technique_du_problème">1.4. Analyse Technique du Problème</a></li>
</ul>
</li>
<li><a href="#pourquoi_un_script_classique_ne_suffit_pas">2. Pourquoi un Script Classique ne Suffit Pas ?</a>
<ul class="sectlevel2">
<li><a href="#lapproche_intuitive_mais_inefficace">2.1. L&#8217;Approche Intuitive mais Inefficace</a></li>
<li><a href="#comprendre_lévénement_domcontentloaded">2.2. Comprendre l&#8217;Événement DOMContentLoaded</a></li>
<li><a href="#le_problème_du_render_blocking">2.3. Le Problème du Render Blocking</a></li>
<li><a href="#visualisation_du_problème">2.4. Visualisation du Problème</a></li>
<li><a href="#les_tentatives_de_solution_inefficaces">2.5. Les Tentatives de Solution Inefficaces</a></li>
<li><a href="#la_vraie_solution_agir_plus_tôt">2.6. La Vraie Solution : Agir Plus Tôt</a></li>
</ul>
</li>
<li><a href="#la_solution_le_chargement_précoce_early_loading">3. La Solution : Le Chargement Précoce (Early Loading)</a>
<ul class="sectlevel2">
<li><a href="#le_principe_fondamental">3.1. Le Principe Fondamental</a></li>
<li><a href="#pourquoi_le_head_est_lendroit_idéal">3.2. Pourquoi le <code>&lt;head&gt;</code> est l&#8217;Endroit Idéal</a></li>
<li><a href="#architecture_de_la_solution_en_trois_couches">3.3. Architecture de la Solution en Trois Couches</a></li>
</ul>
</li>
<li><a href="#étape_1_sauvegarder_le_choix_de_lutilisateur">4. Étape 1 : Sauvegarder le Choix de l&#8217;Utilisateur</a>
<ul class="sectlevel2">
<li><a href="#le_localstorage_votre_mémoire_persistante">4.1. Le localStorage : Votre Mémoire Persistante</a></li>
<li><a href="#implémentation_de_la_sauvegarde_du_thème">4.2. Implémentation de la Sauvegarde du Thème</a></li>
<li><a href="#gestion_des_cas_derreur">4.3. Gestion des Cas d&#8217;Erreur</a></li>
<li><a href="#stratégies_avancées_de_persistance">4.4. Stratégies Avancées de Persistance</a></li>
</ul>
</li>
<li><a href="#étape_2_le_script_de_pré_chargement_dans_le_head">5. Étape 2 : Le Script de Pré-chargement dans le <code>&lt;head&gt;</code></a>
<ul class="sectlevel2">
<li><a href="#le_cœur_de_la_solution">5.1. Le Cœur de la Solution</a></li>
<li><a href="#anatomie_du_script_chaque_ligne_compte">5.2. Anatomie du Script : Chaque Ligne Compte</a></li>
<li><a href="#détection_de_la_préférence_système_bonus">5.3. Détection de la Préférence Système (Bonus)</a></li>
<li><a href="#performance_pourquoi_ce_script_est_rapide">5.4. Performance : Pourquoi ce Script est Rapide</a></li>
<li><a href="#placement_optimal_dans_le_head">5.5. Placement Optimal dans le <code>&lt;head&gt;</code></a></li>
</ul>
</li>
<li><a href="#étape_3_la_puissance_des_sélecteurs_dattributs_css">6. Étape 3 : La Puissance des Sélecteurs d&#8217;Attributs CSS</a>
<ul class="sectlevel2">
<li><a href="#le_système_de_thème_de_bootstrap_5">6.1. Le Système de Thème de Bootstrap 5</a></li>
<li><a href="#structure_css_pour_un_système_de_thème">6.2. Structure CSS pour un Système de Thème</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="résumé">Résumé</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Dans cet article technique approfondi, nous explorons comment implémenter un sélecteur de thème (light/dark) sans le désagréable effet de clignotement qui survient lors du chargement de page. Nous analysons en détail le cycle de rendu du navigateur, les causes profondes du FOUC (Flash of Unstyled Content), et proposons une solution robuste basée sur le pré-chargement synchrone dans le <code>&lt;head&gt;</code>. Cette technique garantit une expérience utilisateur fluide et professionnelle.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="le_problème_ce_maudit_clignotement_de_thème">1. Le Problème : Ce Maudit Clignotement de Thème</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="un_cauchemar_pour_lexpérience_utilisateur">1.1. Un Cauchemar pour l&#8217;Expérience Utilisateur</h3>
<div class="paragraph">
<p>Imaginez la scène : vous avez passé des heures à concevoir un magnifique thème sombre pour votre application web. Les couleurs sont parfaitement équilibrées, le contraste est optimal, et vos utilisateurs adorent cette option. Mais il y a un problème embarrassant : à chaque rechargement de page, pendant une fraction de seconde, le thème clair par défaut s&#8217;affiche avant que le thème sombre ne prenne le relais.</p>
</div>
<div class="paragraph">
<p>Ce "flash" visuel, bien que bref (parfois moins de 100ms), est immédiatement perceptible par l&#8217;œil humain et crée une expérience désagréable. Pour les utilisateurs qui ont choisi le thème sombre pour des raisons de confort visuel ou d&#8217;accessibilité, ce clignotement peut même être douloureux, particulièrement dans un environnement peu éclairé.</p>
</div>
</div>
<div class="sect2">
<h3 id="le_fouc_un_vieux_problème_web">1.2. Le FOUC : Un Vieux Problème Web</h3>
<div class="paragraph">
<p>Ce phénomène est une variante de ce que l&#8217;on appelle le "Flash of Unstyled Content" (FOUC), un problème classique du développement web qui remonte aux premiers jours du CSS. Le FOUC se produit lorsque le navigateur affiche temporairement du contenu HTML sans ses styles CSS appliqués, créant un flash de contenu non stylisé.</p>
</div>
<div class="paragraph">
<p>Dans notre cas spécifique, nous ne parlons pas d&#8217;un contenu complètement non stylisé, mais plutôt d&#8217;un <strong>Flash of Wrong Theme</strong> (FOWT) - le contenu est stylisé, mais avec le mauvais thème. C&#8217;est particulièrement frustrant car cela montre que notre application "oublie" la préférence de l&#8217;utilisateur à chaque chargement de page.</p>
</div>
</div>
<div class="sect2">
<h3 id="impact_sur_la_perception_de_qualité">1.3. Impact sur la Perception de Qualité</h3>
<div class="paragraph">
<p>Ce problème, bien que technique, a des répercussions importantes sur la perception de la qualité de votre application :</p>
</div>
<div class="paragraph">
<p><strong>Manque de polish</strong> : Le clignotement donne l&#8217;impression d&#8217;une application inachevée ou mal optimisée. Les utilisateurs associent souvent ces petits défauts visuels à un manque de professionnalisme général.</p>
</div>
<div class="paragraph">
<p><strong>Rupture de cohérence</strong> : L&#8217;application semble "oublier" les préférences de l&#8217;utilisateur, créant une sensation de désynchronisation entre l&#8217;interface et les attentes.</p>
</div>
<div class="paragraph">
<p><strong>Fatigue visuelle</strong> : Pour les utilisateurs sensibles à la lumière ou souffrant de migraines, ce flash lumineux peut être plus qu&#8217;un simple désagrément esthétique.</p>
</div>
<div class="paragraph">
<p><strong>Performance perçue</strong> : Ironiquement, même si votre site se charge rapidement, ce clignotement peut donner l&#8217;impression d&#8217;une application lente ou peu réactive.</p>
</div>
</div>
<div class="sect2">
<h3 id="analyse_technique_du_problème">1.4. Analyse Technique du Problème</h3>
<div class="paragraph">
<p>Pour comprendre comment résoudre ce problème, il faut d&#8217;abord comprendre pourquoi il se produit. Le clignotement survient à cause d&#8217;un décalage temporel entre trois événements critiques dans le cycle de vie d&#8217;une page web :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Le parsing initial du HTML</strong> : Le navigateur lit et analyse la structure de votre page</p>
</li>
<li>
<p><strong>L&#8217;application des styles CSS</strong> : Le navigateur applique les règles CSS et calcule le rendu visuel</p>
</li>
<li>
<p><strong>L&#8217;exécution du JavaScript</strong> : Votre code qui change le thème s&#8217;exécute</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Le problème survient lorsque l&#8217;événement n°3 (exécution du JavaScript) arrive après que le navigateur a déjà commencé ou terminé l&#8217;événement n°2 (application des styles). À ce moment-là, le navigateur a déjà pris une décision sur quel thème afficher, et votre code arrive trop tard pour l&#8217;influencer avant le premier rendu.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pourquoi_un_script_classique_ne_suffit_pas">2. Pourquoi un Script Classique ne Suffit Pas ?</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="lapproche_intuitive_mais_inefficace">2.1. L&#8217;Approche Intuitive mais Inefficace</h3>
<div class="paragraph">
<p>L&#8217;approche la plus naturelle pour un développeur serait de placer un script à la fin de notre <code>&lt;body&gt;</code> qui vérifie le thème préféré de l&#8217;utilisateur et l&#8217;applique. Cette approche suit les meilleures pratiques traditionnelles du web qui recommandent de charger les scripts en fin de page pour ne pas bloquer le rendu.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// À la fin de &lt;body&gt; - L'APPROCHE INSUFFISANTE
document.addEventListener('DOMContentLoaded', () =&gt; {
  const theme = localStorage.getItem('preferred-theme');
  if (theme === 'dark') {
    document.documentElement.setAttribute('data-bs-theme', 'dark');
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette approche semble logique à première vue. Nous attendons que le DOM soit prêt, puis nous appliquons le thème. Simple, non ? Malheureusement, cette simplicité cache un défaut fondamental lié au timing du cycle de rendu du navigateur.</p>
</div>
</div>
<div class="sect2">
<h3 id="comprendre_lévénement_domcontentloaded">2.2. Comprendre l&#8217;Événement DOMContentLoaded</h3>
<div class="paragraph">
<p>L&#8217;événement <code>DOMContentLoaded</code> se déclenche lorsque le document HTML initial a été complètement chargé et analysé par le navigateur, <strong>sans attendre</strong> la fin du chargement des feuilles de style, des images et des sous-cadres. C&#8217;est un point important à comprendre.</p>
</div>
<div class="paragraph">
<p>Voici la séquence typique des événements :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Le navigateur commence à télécharger le HTML</p>
</li>
<li>
<p>Il analyse le HTML au fur et à mesure de sa réception</p>
</li>
<li>
<p>Il découvre les balises <code>&lt;link&gt;</code> pour les CSS et commence à les télécharger</p>
</li>
<li>
<p>Il découvre les balises <code>&lt;script&gt;</code> et les exécute (selon leur type et attributs)</p>
</li>
<li>
<p>Il construit le DOM (Document Object Model)</p>
</li>
<li>
<p><strong>L&#8217;événement <code>DOMContentLoaded</code> se déclenche</strong></p>
</li>
<li>
<p>Il continue d&#8217;appliquer les styles et de faire le layout</p>
</li>
<li>
<p>Le premier paint (affichage) se produit</p>
</li>
<li>
<p>L&#8217;événement <code>load</code> se déclenche quand toutes les ressources sont chargées</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Le problème ? Entre l&#8217;étape 6 (DOMContentLoaded) et l&#8217;étape 8 (premier paint), le navigateur a déjà pris des décisions sur comment afficher la page. Si votre script de changement de thème s&#8217;exécute à l&#8217;étape 6, il est déjà trop tard pour éviter un premier affichage avec les styles par défaut.</p>
</div>
</div>
<div class="sect2">
<h3 id="le_problème_du_render_blocking">2.3. Le Problème du Render Blocking</h3>
<div class="paragraph">
<p>En réalité, le timing est encore plus complexe. Les navigateurs modernes utilisent des techniques d&#8217;optimisation sophistiquées pour améliorer la performance perçue. Ils essaient de faire le premier paint (First Contentful Paint) le plus rapidement possible pour que l&#8217;utilisateur voie quelque chose à l&#8217;écran.</p>
</div>
<div class="paragraph">
<p>Les CSS sont "render-blocking" par défaut, ce qui signifie que le navigateur attend d&#8217;avoir téléchargé et parsé les feuilles de style avant de faire le premier paint. C&#8217;est logique : on ne veut pas afficher du contenu non stylisé.</p>
</div>
<div class="paragraph">
<p>Mais voici le piège : quand le navigateur applique ces styles CSS pour la première fois, il le fait en se basant sur l&#8217;état actuel du DOM. Si l&#8217;attribut <code>data-bs-theme</code> n&#8217;est pas encore défini sur la balise <code>&lt;html&gt;</code>, le navigateur appliquera les styles par défaut (généralement le thème clair).</p>
</div>
<div class="paragraph">
<p>Ensuite, quand votre script s&#8217;exécute et change cet attribut, le navigateur doit :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Recalculer tous les styles affectés par ce changement</p>
</li>
<li>
<p>Refaire le layout si nécessaire</p>
</li>
<li>
<p>Repeindre les éléments affectés</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ce processus de recalcul et de repeinture est ce qui cause le clignotement visible.</p>
</div>
</div>
<div class="sect2">
<h3 id="visualisation_du_problème">2.4. Visualisation du Problème</h3>
<div class="paragraph">
<p>Pour mieux comprendre cette séquence problématique, examinons un diagramme de séquence détaillé :</p>
</div>
<div id="diag-flux-incorrect" class="imageblock">
<div class="content">
<img src="diag-plantuml-md5-4cecab2bd5c378c47b8154389dfa0d84.svg" alt="Diagramme de séquence du chargement incorrect" width="1488" height="666">
</div>
</div>
<div class="paragraph">
<p>Ce diagramme illustre clairement le problème : le premier paint se produit avant que notre script n&#8217;ait eu la chance de définir le bon thème. Le repaint subséquent crée le clignotement visible.</p>
</div>
</div>
<div class="sect2">
<h3 id="les_tentatives_de_solution_inefficaces">2.5. Les Tentatives de Solution Inefficaces</h3>
<div class="paragraph">
<p>Plusieurs approches ont été tentées pour résoudre ce problème, mais la plupart ont leurs propres inconvénients :</p>
</div>
<div class="paragraph">
<p><strong>Approche 1 : Cacher le contenu jusqu&#8217;au chargement</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-css" data-lang="css">body {
  opacity: 0;
  transition: opacity 0.3s;
}

body.loaded {
  opacity: 1;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette approche cache tout le contenu jusqu&#8217;à ce que le JavaScript ait défini le bon thème. Le problème ? Cela retarde artificiellement l&#8217;affichage du contenu, donnant l&#8217;impression d&#8217;un site plus lent. De plus, si JavaScript est désactivé, l&#8217;utilisateur ne voit rien du tout !</p>
</div>
<div class="paragraph">
<p><strong>Approche 2 : Utiliser un loader/spinner</strong></p>
</div>
<div class="paragraph">
<p>Similaire à l&#8217;approche 1, mais avec un spinner de chargement. Cela masque le problème mais n&#8217;améliore pas la performance réelle et ajoute un délai perçu inutile.</p>
</div>
<div class="paragraph">
<p><strong>Approche 3 : Défaut au thème sombre</strong></p>
</div>
<div class="paragraph">
<p>Certains développeurs définissent le thème sombre comme défaut dans le CSS. Cela évite le clignotement pour les utilisateurs du thème sombre, mais crée le problème inverse pour les utilisateurs du thème clair !</p>
</div>
<div class="paragraph">
<p>Aucune de ces approches n&#8217;est satisfaisante car elles traitent le symptôme plutôt que la cause racine du problème.</p>
</div>
</div>
<div class="sect2">
<h3 id="la_vraie_solution_agir_plus_tôt">2.6. La Vraie Solution : Agir Plus Tôt</h3>
<div class="paragraph">
<p>La clé pour résoudre ce problème est de réaliser que nous devons définir l&#8217;attribut <code>data-bs-theme</code> <strong>avant</strong> que le navigateur ne commence à appliquer les styles CSS. Cela signifie que notre script doit s&#8217;exécuter plus tôt dans le cycle de vie de la page, et c&#8217;est exactement ce que nous allons explorer dans la section suivante.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="la_solution_le_chargement_précoce_early_loading">3. La Solution : Le Chargement Précoce (Early Loading)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="le_principe_fondamental">3.1. Le Principe Fondamental</h3>
<div class="paragraph">
<p>La solution élégante à notre problème de clignotement repose sur un principe simple mais puissant : <strong>synchroniser l&#8217;état de l&#8217;application avec le processus de rendu du navigateur</strong>. Au lieu d&#8217;attendre que la page soit chargée pour définir le thème, nous devons le définir <strong>pendant</strong> le chargement, avant même que les styles CSS ne soient appliqués.</p>
</div>
<div class="paragraph">
<p>Cette approche s&#8217;appelle le "Early Loading" ou "Synchronous Preloading" dans le jargon du développement web. L&#8217;idée est d&#8217;exécuter notre logique de détection de thème le plus tôt possible dans le cycle de vie de la page, idéalement dans la balise <code>&lt;head&gt;</code>, avant même que le navigateur ne commence à télécharger les fichiers CSS.</p>
</div>
</div>
<div class="sect2">
<h3 id="pourquoi_le_head_est_lendroit_idéal">3.2. Pourquoi le <code>&lt;head&gt;</code> est l&#8217;Endroit Idéal</h3>
<div class="paragraph">
<p>Le <code>&lt;head&gt;</code> d&#8217;un document HTML est traité séquentiellement par le navigateur, de haut en bas. Chaque élément est traité dans l&#8217;ordre où il apparaît. Cette caractéristique est cruciale pour notre solution.</p>
</div>
<div class="paragraph">
<p>Lorsque le navigateur rencontre une balise <code>&lt;script&gt;</code> dans le <code>&lt;head&gt;</code> sans les attributs <code>async</code> ou <code>defer</code>, il :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Interrompt le parsing du HTML</strong></p>
</li>
<li>
<p><strong>Télécharge le script</strong> (si externe) ou le lit (si inline)</p>
</li>
<li>
<p><strong>Exécute immédiatement le script</strong></p>
</li>
<li>
<p><strong>Reprend le parsing du HTML</strong></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Ce comportement, souvent considéré comme un problème de performance (d&#8217;où la recommandation habituelle de placer les scripts en fin de page), devient notre allié dans ce cas précis. En plaçant notre script de détection de thème au début du <code>&lt;head&gt;</code>, nous garantissons qu&#8217;il s&#8217;exécute avant que le navigateur ne rencontre les balises <code>&lt;link&gt;</code> de nos feuilles de style.</p>
</div>
</div>
<div class="sect2">
<h3 id="architecture_de_la_solution_en_trois_couches">3.3. Architecture de la Solution en Trois Couches</h3>
<div class="paragraph">
<p>Notre solution complète se compose de trois couches interdépendantes, chacune jouant un rôle spécifique :</p>
</div>
<div class="paragraph">
<p><strong>Couche 1 : Persistence (localStorage)</strong>
Cette couche est responsable de la sauvegarde et de la récupération du choix de l&#8217;utilisateur entre les sessions.</p>
</div>
<div class="paragraph">
<p><strong>Couche 2 : Synchronisation Précoce (Script inline dans <code>&lt;head&gt;</code>)</strong>
Cette couche synchronise l&#8217;état de l&#8217;application avec le DOM avant le rendu initial.</p>
</div>
<div class="paragraph">
<p><strong>Couche 3 : Styles Réactifs (CSS avec sélecteurs d&#8217;attributs)</strong>
Cette couche définit les styles visuels basés sur l&#8217;état défini par la couche 2.</p>
</div>
<div class="paragraph">
<p>Explorons maintenant chaque couche en détail.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="étape_1_sauvegarder_le_choix_de_lutilisateur">4. Étape 1 : Sauvegarder le Choix de l&#8217;Utilisateur</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="le_localstorage_votre_mémoire_persistante">4.1. Le localStorage : Votre Mémoire Persistante</h3>
<div class="paragraph">
<p>Le <code>localStorage</code> est une API Web Storage qui permet de stocker des paires clé-valeur dans le navigateur de manière persistante. Contrairement aux cookies, les données du <code>localStorage</code> :</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ne sont jamais envoyées au serveur automatiquement</p>
</li>
<li>
<p>Ont une capacité de stockage plus importante (généralement 5-10MB)</p>
</li>
<li>
<p>N&#8217;ont pas de date d&#8217;expiration (persistent jusqu&#8217;à suppression explicite)</p>
</li>
<li>
<p>Sont limitées au protocole et au domaine (Same-Origin Policy)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pour notre cas d&#8217;usage, le <code>localStorage</code> est parfait car :</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Nous n&#8217;avons pas besoin de partager cette information avec le serveur</p>
</li>
<li>
<p>Nous voulons que la préférence persiste indéfiniment</p>
</li>
<li>
<p>La taille de stockage requise est minime (quelques octets)</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="implémentation_de_la_sauvegarde_du_thème">4.2. Implémentation de la Sauvegarde du Thème</h3>
<div class="paragraph">
<p>Voici comment nous sauvegardons le choix de l&#8217;utilisateur lorsqu&#8217;il change de thème :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">// Fonction complète pour changer le thème
function setTheme(newTheme) {
  // Validation de l'entrée
  if (!['light', 'dark', 'auto'].includes(newTheme)) {
    console.error('Thème invalide:', newTheme);
    return;
  }

  try {
    // Sauvegarde dans localStorage
    localStorage.setItem('preferred-theme', newTheme);

    // Application immédiate dans le DOM
    document.documentElement.setAttribute('data-bs-theme', newTheme);

    // Dispatch d'un événement personnalisé pour notifier d'autres composants
    window.dispatchEvent(new CustomEvent('theme-changed', {
      detail: { theme: newTheme }
    }));

    console.log('Thème changé:', newTheme);
  } catch (error) {
    console.error('Erreur lors de la sauvegarde du thème:', error);
    // Fallback : on applique quand même le thème visuellement
    document.documentElement.setAttribute('data-bs-theme', newTheme);
  }
}

// Exemple d'utilisation avec un bouton
document.getElementById('theme-toggle').addEventListener('click', () =&gt; {
  const currentTheme = document.documentElement.getAttribute('data-bs-theme') || 'light';
  const newTheme = currentTheme === 'light' ? 'dark' : 'light';
  setTheme(newTheme);
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="gestion_des_cas_derreur">4.3. Gestion des Cas d&#8217;Erreur</h3>
<div class="paragraph">
<p>Il est crucial de gérer les cas où le <code>localStorage</code> n&#8217;est pas disponible ou accessible. Plusieurs scénarios peuvent empêcher l&#8217;accès au <code>localStorage</code> :</p>
</div>
<div class="paragraph">
<p><strong>Navigation privée stricte</strong> : Safari en mode navigation privée lève une exception <code>QuotaExceededError</code> lors de tentatives d&#8217;écriture dans le <code>localStorage</code>.</p>
</div>
<div class="paragraph">
<p><strong>Paramètres de confidentialité</strong> : Certains navigateurs ou extensions de confidentialité peuvent bloquer l&#8217;accès au <code>localStorage</code>.</p>
</div>
<div class="paragraph">
<p><strong>Limitations de domaine</strong> : Le <code>localStorage</code> n&#8217;est pas accessible sur le protocole <code>file://</code> dans certains navigateurs.</p>
</div>
<div class="paragraph">
<p><strong>Espace de stockage saturé</strong> : Bien que rare, l&#8217;espace de stockage peut être complètement rempli.</p>
</div>
<div class="paragraph">
<p>C&#8217;est pourquoi notre code utilise un bloc <code>try&#8230;&#8203;catch</code> pour gérer ces cas gracieusement, en continuant d&#8217;offrir la fonctionnalité de changement de thème même si la persistance n&#8217;est pas disponible.</p>
</div>
</div>
<div class="sect2">
<h3 id="stratégies_avancées_de_persistance">4.4. Stratégies Avancées de Persistance</h3>
<div class="paragraph">
<p>Pour des applications plus sophistiquées, vous pouvez envisager des stratégies supplémentaires :</p>
</div>
<div class="paragraph">
<p><strong>Synchronisation serveur (optionnelle)</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">async function setTheme(newTheme) {
  // Sauvegarde locale immédiate
  localStorage.setItem('preferred-theme', newTheme);
  document.documentElement.setAttribute('data-bs-theme', newTheme);

  // Synchronisation serveur en arrière-plan (si l'utilisateur est connecté)
  if (userIsAuthenticated()) {
    try {
      await fetch('/api/user/preferences', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ theme: newTheme })
      });
    } catch (error) {
      console.warn('Échec de la synchronisation serveur:', error);
      // L'échec n'est pas critique car la préférence est déjà sauvegardée localement
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette approche permet de synchroniser les préférences entre appareils pour les utilisateurs connectés, tout en gardant la réactivité locale immédiate.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="étape_2_le_script_de_pré_chargement_dans_le_head">5. Étape 2 : Le Script de Pré-chargement dans le <code>&lt;head&gt;</code></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="le_cœur_de_la_solution">5.1. Le Cœur de la Solution</h3>
<div class="paragraph">
<p>C&#8217;est ici que la magie opère véritablement. Nous allons placer un petit script <strong>inline</strong> directement dans notre <code>&lt;head&gt;</code>, avant toutes nos balises <code>&lt;link&gt;</code> de feuilles de style. Ce script est volontairement minimaliste, autonome, et conçu pour s&#8217;exécuter le plus rapidement possible.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;!DOCTYPE html&gt;
&lt;html lang="fr"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;Mon Site Incroyable&lt;/title&gt;

    &lt;!-- ==========================================
         NOTRE SCRIPT MAGIQUE DE PRÉ-CHARGEMENT
         Ce script DOIT être le premier élément
         dans le &lt;head&gt; après les meta tags
         ========================================== --&gt;
    &lt;script&gt;
      // IIFE pour ne pas polluer le scope global
      (function() {
        'use strict';

        try {
          // Lecture de la préférence sauvegardée
          const savedTheme = localStorage.getItem('preferred-theme');

          // Si une préférence existe, on l'applique immédiatement
          if (savedTheme) {
            document.documentElement.setAttribute('data-bs-theme', savedTheme);
          }
          // Optionnel : Détecter la préférence système si aucune sauvegarde
          else if (window.matchMedia &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.setAttribute('data-bs-theme', 'dark');
          }
          // Sinon, le thème par défaut du CSS sera utilisé (généralement 'light')

        } catch (error) {
          // En cas d'erreur (localStorage bloqué, etc.), on log discrètement
          // et on laisse le thème par défaut s'appliquer
          console.warn('Impossible de charger la préférence de thème:', error);
        }
      })();
    &lt;/script&gt;
    &lt;!-- FIN DU SCRIPT MAGIQUE --&gt;

    &lt;!-- Les feuilles de style sont chargées APRÈS le script --&gt;
    &lt;link rel="stylesheet" href="css/bootstrap.min.css"&gt;
    &lt;link rel="stylesheet" href="css/styles.css"&gt;

    &lt;!-- Autres ressources du head --&gt;
    &lt;link rel="icon" href="favicon.ico"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;!-- Contenu de la page --&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="anatomie_du_script_chaque_ligne_compte">5.2. Anatomie du Script : Chaque Ligne Compte</h3>
<div class="paragraph">
<p>Décortiquons ce script ligne par ligne pour comprendre chaque décision de design :</p>
</div>
<div class="paragraph">
<p><strong>L&#8217;IIFE (Immediately Invoked Function Expression)</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">(function() {
  // ...
})();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette structure crée une fonction qui s&#8217;exécute immédiatement. Pourquoi ? Pour isoler nos variables dans un scope local et éviter de polluer le scope global. Même si nous n&#8217;utilisons que <code>const</code> (qui a un scope de bloc), l&#8217;IIFE est une bonne pratique qui rend nos intentions claires et protège contre d&#8217;éventuels conflits de noms.</p>
</div>
<div class="paragraph">
<p><strong>Le Mode Strict</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">'use strict';</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette directive active le mode strict de JavaScript, qui :
- Interdit l&#8217;utilisation de variables non déclarées
- Génère des erreurs pour les opérations dangereuses
- Améliore les performances dans certains moteurs JavaScript</p>
</div>
<div class="paragraph">
<p>Pour un script critique comme celui-ci, nous voulons la sécurité maximale.</p>
</div>
<div class="paragraph">
<p><strong>Le Bloc try&#8230;&#8203;catch</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">try {
  // Code principal
} catch (error) {
  console.warn('Impossible de charger la préférence de thème:', error);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ce bloc est absolument crucial. Il garantit que si quelque chose se passe mal (localStorage bloqué, erreur de syntaxe improbable, etc.), notre script ne bloquera pas le chargement de la page entière. L&#8217;utilisation de <code>console.warn</code> plutôt que <code>console.error</code> indique que c&#8217;est un problème non-critique.</p>
</div>
<div class="paragraph">
<p><strong>La Lecture du localStorage</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">const savedTheme = localStorage.getItem('preferred-theme');</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette ligne peut lever une exception dans certains contextes (navigation privée stricte de Safari). C&#8217;est pourquoi elle est dans un bloc try&#8230;&#8203;catch.</p>
</div>
<div class="paragraph">
<p><strong>L&#8217;Application Conditionnelle</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">if (savedTheme) {
  document.documentElement.setAttribute('data-bs-theme', savedTheme);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Nous appliquons le thème seulement si nous en avons trouvé un sauvegardé. Sinon, nous laissons le CSS utiliser son thème par défaut. Cette approche est plus robuste qu&#8217;une valeur par défaut côdée en dur dans le JavaScript.</p>
</div>
</div>
<div class="sect2">
<h3 id="détection_de_la_préférence_système_bonus">5.3. Détection de la Préférence Système (Bonus)</h3>
<div class="paragraph">
<p>Une amélioration optionnelle mais élégante consiste à détecter la préférence de thème du système d&#8217;exploitation de l&#8217;utilisateur s&#8217;il n&#8217;a pas encore fait de choix explicite dans votre application :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-javascript" data-lang="javascript">else if (window.matchMedia &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches) {
  document.documentElement.setAttribute('data-bs-theme', 'dark');
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette fonctionnalité utilise la Media Query <code>prefers-color-scheme</code> pour interroger le système. Sur macOS, Windows 10+, iOS, et Android moderne, cette requête retourne la préférence système de l&#8217;utilisateur.</p>
</div>
<div class="paragraph">
<p><strong>Avantages :</strong>
- Expérience personnalisée dès la première visite
- Cohérence avec l&#8217;environnement système de l&#8217;utilisateur
- Aucun stockage nécessaire pour la première visite</p>
</div>
<div class="paragraph">
<p><strong>Considérations :</strong>
- Tous les navigateurs ne supportent pas cette fonctionnalité (mais le support est excellent depuis 2020)
- La vérification <code>window.matchMedia</code> assure la compatibilité
- L&#8217;utilisateur peut toujours surcharger ce choix</p>
</div>
</div>
<div class="sect2">
<h3 id="performance_pourquoi_ce_script_est_rapide">5.4. Performance : Pourquoi ce Script est Rapide</h3>
<div class="paragraph">
<p>Notre script de pré-chargement est conçu pour être extrêmement rapide :</p>
</div>
<div class="paragraph">
<p><strong>Taille minime</strong> : Environ 300 octets non-minifiés, 200 octets minifiés. C&#8217;est négligeable comparé à n&#8217;importe quelle image ou librairie JavaScript.</p>
</div>
<div class="paragraph">
<p><strong>Inline</strong> : Pas de requête HTTP supplémentaire. Le script est dans le HTML, donc il est immédiatement disponible.</p>
</div>
<div class="paragraph">
<p><strong>Opérations synchrones simples</strong> : Lecture d&#8217;une clé dans le localStorage (opération ultra-rapide) et modification d&#8217;un attribut DOM (opération native du navigateur).</p>
</div>
<div class="paragraph">
<p><strong>Aucune dépendance</strong> : Pas de framework, pas de librairie, juste du JavaScript vanilla. Pas de temps de démarrage, pas de parsing de dépendances.</p>
</div>
<div class="paragraph">
<p><strong>Exécution unique</strong> : Ce script s&#8217;exécute une seule fois au chargement. Pas de listeners d&#8217;événements, pas de boucles, pas de calculs complexes.</p>
</div>
<div class="paragraph">
<p>En pratique, sur du matériel moderne, ce script s&#8217;exécute en moins de 1 milliseconde, un temps imperceptible qui n&#8217;a aucun impact sur la performance de chargement de la page.</p>
</div>
</div>
<div class="sect2">
<h3 id="placement_optimal_dans_le_head">5.5. Placement Optimal dans le <code>&lt;head&gt;</code></h3>
<div class="paragraph">
<p>L&#8217;ordre des éléments dans le <code>&lt;head&gt;</code> est important. Voici l&#8217;ordre recommandé :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-html" data-lang="html">&lt;head&gt;
    &lt;!-- 1. Métadonnées critiques --&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;

    &lt;!-- 2. Notre script de pré-chargement (IMMÉDIATEMENT après les meta) --&gt;
    &lt;script&gt;
      (function() { /* notre code */ })();
    &lt;/script&gt;

    &lt;!-- 3. Titre de la page --&gt;
    &lt;title&gt;Mon Site&lt;/title&gt;

    &lt;!-- 4. Feuilles de style --&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;

    &lt;!-- 5. Autres ressources (fonts, favicons, etc.) --&gt;
    &lt;link rel="preconnect" href="https://fonts.googleapis.com"&gt;
    &lt;link rel="icon" href="favicon.ico"&gt;

    &lt;!-- 6. Autres scripts avec defer ou async --&gt;
    &lt;script src="app.js" defer&gt;&lt;/script&gt;
&lt;/head&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cette ordre garantit que :
1. Le charset est défini avant tout traitement de texte
2. Notre script s&#8217;exécute avant le chargement des CSS
3. Les CSS sont chargés ensuite et appliquent directement le bon thème
4. Les autres ressources non-critiques sont chargées en dernier</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="étape_3_la_puissance_des_sélecteurs_dattributs_css">6. Étape 3 : La Puissance des Sélecteurs d&#8217;Attributs CSS</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="le_système_de_thème_de_bootstrap_5">6.1. Le Système de Thème de Bootstrap 5</h3>
<div class="paragraph">
<p>Bootstrap 5 a introduit un système élégant de gestion des thèmes basé sur les custom properties CSS (variables CSS) et les sélecteurs d&#8217;attributs. Ce système utilise l&#8217;attribut <code>data-bs-theme</code> sur l&#8217;élément <code>&lt;html&gt;</code> pour déterminer quel ensemble de variables de couleur appliquer.</p>
</div>
<div class="paragraph">
<p>La beauté de ce système réside dans sa simplicité : au lieu de charger différentes feuilles de style ou de toggle des classes sur des milliers d&#8217;éléments, nous changeons simplement un attribut sur un seul élément, et le CSS fait le reste grâce à la cascade.</p>
</div>
</div>
<div class="sect2">
<h3 id="structure_css_pour_un_système_de_thème">6.2. Structure CSS pour un Système de Thème</h3>
<div class="paragraph">
<p>Voici une structure CSS complète pour implémenter un système de thème robuste :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-css" data-lang="css">/**
 * SYSTÈME DE THÈME COMPLET
 * Utilise les Custom Properties CSS pour une maintenance facile
 */

/* ============================================
   THÈME PAR DÉFAUT (LIGHT)
   Défini sur :root pour être le fallback
   ============================================ */
:root {
  /* Couleurs de base */
  --color-primary: #0d6efd;
  --color-secondary: #6c757d;
  --color-success: #198754;
  --color-danger: #dc3545;
  --color-warning: #ffc107;
  --color-info: #0dcaf0;

  /* Couleurs de fond */
  --bg-primary: #ffffff;
  --bg-secondary: #f8f9fa;
  --bg-tertiary: #e9ecef;

  /* Couleurs de texte */
  --text-primary: #212529;
  --text-secondary: #6c757d;
  --text-tertiary: #adb5bd;

  /* Couleurs de bordure */
  --border-color: #dee2e6;
  --border-color-subtle: #e9ecef;

  /* Couleurs d'ombre */
  --shadow-sm: rgba(0, 0, 0, 0.075);
  --shadow-md: rgba(0, 0, 0, 0.15);
  --shadow-lg: rgba(0, 0, 0, 0.25</code></pre>
</div>
</div>
</div>
</div>
</div></div>

            <!-- Section Commentaires Disqus -->
            <section id="disqus_thread" class="mt-5"></section>
            <script>
                /*<![CDATA[*/
                var disqus_identifier = "blog\/2025\/0098_preloading_css_variable_post.html";

                (({disqus_shortname, document}) => {
                    injectScript('//' + disqus_shortname + '.disqus.com/embed.js');
                    injectScript('//' + disqus_shortname + '.disqus.com/count.js');

                    function injectScript(url) {
                        const s = document.createElement('script');
                        s.async = true;
                        s.src = url;
                        (document.head || document.body).appendChild(s);
                    }
                })({'disqus_shortname': 'cheroliv', 'document': document});
                /*]]>*/
            </script>
            <noscript>
                <div class="alert alert-warning">
                    Veuillez activer JavaScript pour voir les
                    <a href="https://disqus.com/?ref_noscript" class="alert-link">commentaires propulsés par Disqus</a>.
                </div>
            </noscript>

        </article>
    </main>
</div>

<div>
    <!-- Footer -->
    <footer class="enhanced-footer">
        <div class="container">
            <div class="row">
                <!-- Brand Section -->
                <div class="col-lg-2 col-md-6 mb-4 mb-lg-0">
                    <h5 class="fw-bold">
                        <i class="bi bi-code-slash me-2"></i>
                        CHEROLIV
                    </h5>
                    <p class="footer-description">
                        Développeur formateur spécialisé en ingénierie pédagogique.
                        Conception de solutions e-learning innovantes pour transformer l'apprentissage.
                    </p>
                    <div class="social-icons">
                        <a href="https://github.com/cheroliv" target="_blank" aria-label="GitHub">
                            <i class="fab fa-github"></i>
                        </a>
                        <!--                        <a href="#" aria-label="LinkedIn">-->
                        <!--                            <i class="fab fa-linkedin-in"></i>-->
                        <!--                        </a>-->
                        <!--                        <a href="#" aria-label="Twitter">-->
                        <!--                            <i class="fab fa-twitter"></i>-->
                        <!--                        </a>-->
                        <a href="feed.xml" aria-label="RSS Feed">
                            <i class="fas fa-rss"></i>
                        </a>
                        <a href="mailto:cheroliv.developer@gmail.com" target="_blank" aria-label="Mail">
                            <i class="fas fa-paper-plane"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Links -->
                <div class="col-lg-2 col-md-6 mb-4 mb-lg-0">
                    <h6 class="fw-bold">Navigation</h6>
                    <ul class="footer-links">
                        <li><a href="../../index.html"><i class="bi bi-chevron-right"></i>Accueil</a></li>
                        <!--                        <li><a th:href="${content.rootpath} + 'index.html#about'"><i class="bi bi-chevron-right"></i>À propos</a></li>-->
                        <li><a href="../../index.html#services"><i class="bi bi-chevron-right"></i>Services</a></li>
                        <!--                        <li><a th:href="${content.rootpath} + 'index.html#portfolio'"><i class="bi bi-chevron-right"></i>Portfolio</a></li>-->
                        <li><a href="../../blog.html"><i class="bi bi-chevron-right"></i>Blog</a></li>
                    </ul>
                </div>

                <!-- Resources -->
                <div class="col-lg-2 col-md-6 mb-4 mb-lg-0">
                    <h6 class="fw-bold">Ressources</h6>
                    <ul class="footer-links">
                        <!--                        <li><a th:href="${content.rootpath} + 'index.html#formations'"><i class="bi bi-book"></i>Formations</a></li>-->
                        <li><a href="../../blog.html"><i class="bi bi-journal-text"></i>Articles</a></li>
                        <li><a href="../../archive.html"><i class="bi bi-archive"></i>Archives</a></li>
                        <li><a><i class="bi bi-journal-bookmark"></i>Mémos</a></li>
                        <li><a href="https://pages-content.github.io/slides/" target="_blank"><i class="fa-regular fa-file-powerpoint"></i> slides</a></li>
                        <li><a href="https://talaria-formation.github.io/formations/index.html" target="_blank"><i class="fa-solid fa-graduation-cap"></i> trainings</a></li>
                        <!--                        <li><a href="#"><i class="bi bi-file-earmark-pdf"></i>Documentation</a></li>-->
                        <!--                        <li><a href="#"><i class="bi bi-youtube"></i>Tutoriels vidéo</a></li>-->
                    </ul>
                </div>

                <!-- Contact Section -->
<!--                <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">-->
<!--                    <h6 class="fw-bold">Me contacter</h6>-->
<!--                    <p class="mb-3">Une question ? Un projet ? N'hésitez pas à me contacter.</p>-->
<!--                    <ul class="contact-info">-->
<!--                        <li>-->
<!--                            <i class="bi bi-envelope-fill"></i>-->
<!--                            <a th:href="${content.rootpath} + 'index.html#contact'">-->
<!--                                Formulaire de contact-->
<!--                            </a>-->
<!--                        </li>-->
<!--                        <li>-->
<!--                            <i class="bi bi-clock-fill"></i>-->
<!--                            <span>Réponse sous 24-48h</span>-->
<!--                        </li>-->
<!--                    </ul>-->
<!--                </div>-->

                <!-- Location Section -->
                <div class="col-lg-3 col-md-6">
                    <h6 class="fw-bold">Localisation</h6>
                    <p class="mb-3">Basé en région parisienne, interventions possibles en France et à distance.</p>
                    <ul class="contact-info">
                        <li>
                            <i class="bi bi-geo-alt-fill"></i>
                            <span>Île-de-France, France</span>
                        </li>
                        <li>
                            <i class="bi bi-globe"></i>
                            <span>Télétravail disponible</span>
                        </li>
                        <li>
                            <i class="bi bi-pin-map-fill"></i>
                            <span>Déplacements en France</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- Footer Bottom -->
            <hr class="footer-divider">
            <div class="footer-bottom">
                <p>&copy; 2018-<span>2026</span> Cheroliv. Tous droits réservés.</p>
                <div class="footer-bottom-links">
                    <a href="#">Politique de confidentialité</a>
                    <a href="#">Conditions d'utilisation</a>
                    <a href="#">Mentions légales</a>
                    <a href="#">Plan du site</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5.3 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Supabase Credentials Injection -->
    <script>
        /*<![CDATA[*/
        const SUPABASE_URL = null;
        const SUPABASE_KEY = null;
        /*]]>*/
    </script>
    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/go.min.js"></script>
    <script>hljs.highlightAll();</script>
    <!-- intl-tel-input JS -->
    <script src="https://cdn.jsdelivr.net/npm/intl-tel-input@25.10.1/build/js/intlTelInput.min.js"></script>
    <!-- Custom JS -->
    <script src="../../js/script.js"></script>
    <script src="../../js/contact.js"></script>
</div>
</body>
</html>
